webpackJsonp([2],{"5Z7Z":function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=e("iumI"),a=e.n(i);for(var c in i)"default"!==c&&function(t){e.d(s,t,function(){return i[t]})}(c);var n=e("DVp3");var o=function(t){e("Vbc3")},l=e("VU/8")(a.a,n.a,!1,o,null,null);s.default=l.exports},DVp3:function(t,s,e){"use strict";var i={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{attrs:{id:"cart"}},[e("div",{staticClass:"header"},[e("i",{staticClass:"iconfont icon-xiangzuo",on:{click:t.back}}),t._v(" "),e("div",{staticClass:"text"},[t._v("\n      购物车\n      "),t.count>0?e("span",[t._v("("+t._s(t.count)+")")]):t._e()])]),t._v(" "),e("div",{ref:"cartScroll",staticClass:"contentWrapper"},[e("div",{staticClass:"content"},[t.count<1?e("div",{staticClass:"empty"},[t._m(0),t._v(" "),e("div",{staticClass:"text1"},[t._v("购物车快饿瘪了T.T")]),t._v(" "),e("div",{staticClass:"text2"},[t._v("主人快给我挑点宝贝吧")]),t._v(" "),e("div",{staticClass:"text3"},[e("span",{on:{click:t.tohome}},[t._v("去逛逛")])])]):t._e(),t._v(" "),t.count>0?e("div",{staticClass:"cartList"},[e("div",{staticClass:"edit"},[e("span",{on:{click:t.editGood}},[t._v(t._s(t.edit))])]),t._v(" "),t._l(t.cartList,function(s,i){return e("div",{key:i,staticClass:"goods"},[e("div",{staticClass:"left"},[e("div",{staticClass:"circle",class:{checked:t.selectList[i]},on:{click:function(s){t.select(i)}}},[e("i",{staticClass:"iconfont icon-check"})]),t._v(" "),e("img",{attrs:{src:s.path,alt:""}})]),t._v(" "),e("div",{staticClass:"right"},[e("div",{directives:[{name:"show",rawName:"v-show",value:"编辑"==t.edit,expression:"edit == '编辑'"}],staticClass:"desc"},[e("div",{staticClass:"name"},[t._v(t._s(s.name))]),t._v(" "),e("div",{staticClass:"info"},[t._v(t._s(s.info))]),t._v(" "),e("div",{staticClass:"wrapper"},[e("span",{staticClass:"realityPrice"},[t._v("￥"+t._s(s.realityPrice))]),t._v(" "),e("span",{staticClass:"price"},[t._v("￥"+t._s(s.price))]),t._v(" "),e("span",{staticClass:"num"},[t._v("x"+t._s(s.num))])])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"完成"==t.edit,expression:"edit == '完成'"}],staticClass:"editModel"},[e("div",{ref:"goodInfo",refInFor:!0,staticClass:"goodInfo"},[e("div",{staticClass:"changeNum"},[e("i",{staticClass:"iconfont icon-jianhao",class:{numActive:s.num>1},on:{click:function(e){t.sub(i,s.id,s.num)}}}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:s.num,expression:"item.num"}],attrs:{type:"text"},domProps:{value:s.num},on:{blur:function(e){t.blur(s.num,i,s.stock,s.id)},input:function(e){e.target.composing||t.$set(s,"num",e.target.value)}}}),t._v(" "),e("i",{staticClass:"iconfont icon-jiahao",class:{numActive:t.addCheck},on:{click:function(e){t.add(i,s.id,s.num,s.stock)}}})]),t._v(" "),e("div",{staticClass:"text"},[t._v(t._s(s.info))])]),t._v(" "),e("div",{ref:"deleteGood",refInFor:!0,staticClass:"delete",on:{click:function(e){t.deleteGood(s.id)}}},[t._v("删除")])])])])})],2):t._e()])]),t._v(" "),t.count>0?e("div",{staticClass:"footer"},[e("div",{staticClass:"allCheck"},[e("div",{staticClass:"selctAll",class:{checked:t.selectAll},on:{click:t.selectAllGood}},[e("i",{staticClass:"iconfont icon-check"})]),t._v(" "),e("div",{on:{click:t.selectAllGood}},[t._v("全选")])]),t._v(" "),e("div",{staticClass:"settlement"},[e("div",[t._v("合计: ")]),t._v(" "),e("div",{staticClass:"total"},[t._v("￥"+t._s(t.totalPrice))]),t._v(" "),e("div",{on:{click:t.settlement}},[t._v("结算")])])]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"cartIcon"},[s("i",{staticClass:"iconfont icon-gouwuche"})])}]};s.a=i},Vbc3:function(t,s){},iumI:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=o(e("mvHQ")),a=o(e("uAC3")),c=o(e("GQaK")),n=e("wSez");function o(t){return t&&t.__esModule?t:{default:t}}s.default={name:"Cart",data:function(){return{count:0,edit:"编辑",num:1,addCheck:!0,cartList:[],stock:[],selectList:[],selectAll:!1}},computed:{totalPrice:function(){var t=this,s=0;this.selectList.forEach(function(e,i){e&&(s+=t.cartList[i].num*t.cartList[i].realityPrice)});var e=s.toString().search(/\./);return e>0&&(s=s.toString().substring(0,e+3)),s}},methods:{blur:function(t,s,e,i){var a=parseInt(/[1-9]{1}[0-9]*/.exec(t));a<1?(this.cartList[s].num=1,this.$toast({message:"真的不能再少了",duration:2e3})):a>e?(this.cartList[s].num=e,this.$toast({message:"库存仅剩"+e,duration:2e3})):this.cartList[s].num=a,this.updateNum(i,this.cartList[s].num)},init:function(){var t=this;this.$axios.get("/cart/getCartList",{params:{userId:a.default.get("userId")}}).then(function(s){if(1==s.data.code){t.cartList=s.data.res,t.count=t.cartList.length,t.selectList=[],t.selectAll=!1;for(var e=0;e<t.cartList.length;e++)t.selectList.push(!1)}else t.$toast({message:"数据请求失败，请稍后再试或刷新",duration:2e3})})},back:function(){this.$router.go(-1)},tohome:function(){this.$router.push({path:"/"})},editGood:function(){var t=this,s=document.querySelectorAll(".goodInfo"),e=document.querySelectorAll(".delete");if("编辑"==this.edit)this.edit="完成",setTimeout(function(){for(var t=0;t<s.length;t++)s[t].style.width="75%",e[t].style.width="24%"},100);else{for(var i=0;i<s.length;i++)s[i].style.width="99%",e[i].style.width="0";setTimeout(function(){t.edit="编辑"},500)}},add:function(t,s,e,i){e<i?(this.cartList[t].num++,this.updateNum(s,this.cartList[t].num)):this.$toast({message:"库存仅剩"+i,duration:2e3})},sub:function(t,s,e){e>1?(this.cartList[t].num--,this.updateNum(s,this.cartList[t].num)):this.$toast({message:"真的不能再少了",duration:2e3})},updateNum:function(t,s){var e=this;this.$axios.put("/cart/updateNum",{id:t,num:s}).then(function(t){1!=t.data.code&&e.$toast({message:t.data.msg,duration:2e3})})},deleteGood:function(t){var s=this;n.MessageBox.confirm("你确定要删除该商品吗?").then(function(e){s.$axios.delete("/cart/delete?id="+t).then(function(t){1!=t.data.code?s.$toast({message:t.data.msg,duration:2e3}):s.init()})})},initScroll:function(){this.cartScroll?this.cartScroll.refresh():this.cartScroll=new c.default(this.$refs.cartScroll,{click:!0,probeType:3})},select:function(t){var s=!this.selectList[t];this.$set(this.selectList,t,s);var e=this.selectList.every(function(t){return t});this.selectAll=!!e},selectAllGood:function(){var t=this;this.selectAll=!this.selectAll,this.selectList.forEach(function(s,e){t.$set(t.selectList,e,t.selectAll)}),console.log(this.selectList)},settlement:function(){var t=this,s=[];this.selectList.forEach(function(e,i){e&&s.push(t.cartList[i].id)}),this.$axios.delete("/cart/deleteAll?arr="+(0,i.default)(s)).then(function(s){t.$toast({message:s.data.msg,duration:2e3}),1==s.data.code&&setTimeout(function(){t.$router.push({name:"message"})},2e3)})}},created:function(){this.init()},mounted:function(){this.initScroll()}}},mvHQ:function(t,s,e){t.exports={default:e("qkKv"),__esModule:!0}},qkKv:function(t,s,e){var i=e("FeBl"),a=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return a.stringify.apply(a,arguments)}}});
//# sourceMappingURL=2.764d2484f072344ca4ed.js.map